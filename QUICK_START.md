# ğŸš€ FigTabMiner æ”¹è¿›ç‰ˆ - å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸ“‹ æ”¹è¿›æ¦‚è¿°

æœ¬ç‰ˆæœ¬ä¸»è¦æ”¹è¿›ï¼š
1. âœ… **ä¿®å¤æ¨¡å‹åŠ è½½é—®é¢˜** - 100% æˆåŠŸç‡
2. âœ… **æ™ºèƒ½è¾¹ç•Œæ¡†åˆå¹¶** - å‡å°‘è¿‡åº¦åˆ†å‰²ï¼Œè¿‡æ»¤ç®­å¤´
3. âœ… **è´¨é‡è¯„ä¼°ç³»ç»Ÿ** - å¤šç»´åº¦è¯„åˆ†å’Œè¿‡æ»¤
4. âœ… **è¯¦ç»†æ—¥å¿—** - æ›´å¥½çš„è°ƒè¯•å’Œç›‘æ§

## ğŸ¯ å¿«é€ŸéªŒè¯æ”¹è¿›æ•ˆæœ

### æ–¹æ³• 1ï¼šè¿è¡Œæµ‹è¯•å¥—ä»¶ï¼ˆæ¨èï¼‰

```bash
# ä¸€é”®è¿è¡Œæ‰€æœ‰æµ‹è¯•
bash run_tests.sh
```

è¿™ä¼šè¿è¡Œï¼š
- æ¨¡å‹åŠ è½½æµ‹è¯•
- æå–åŠŸèƒ½æµ‹è¯•
- æ€§èƒ½å¯¹æ¯”æµ‹è¯•

### æ–¹æ³• 2ï¼šç”Ÿæˆå¯è§†åŒ–æŠ¥å‘Š

```bash
# å…ˆè¿è¡Œæå–ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ç»“æœï¼‰
python scripts/run_pipeline.py --pdf data/samples/your_paper.pdf

# ç”Ÿæˆ HTML æŠ¥å‘Š
python tools/visualize_results.py

# åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€
firefox extraction_report.html  # æˆ– chrome, safari ç­‰
```

### æ–¹æ³• 3ï¼šå•ç‹¬æµ‹è¯•ä¸€ä¸ª PDF

```bash
python tests/test_improved_extraction.py
```

## ğŸ“Š å¦‚ä½•åˆ¤æ–­æ”¹è¿›æ•ˆæœ

### 1. æŸ¥çœ‹åˆå¹¶ç»Ÿè®¡

è¿è¡Œæµ‹è¯•åï¼ŒæŸ¥çœ‹è¾“å‡ºä¸­çš„ "Merging statistics"ï¼š

```
Merging statistics:
  Figures merged: 26
  Merge rate: 70.3%
```

**70.3% çš„åˆå¹¶ç‡**è¡¨ç¤ºç³»ç»ŸæˆåŠŸå°†è¿‡åº¦åˆ†å‰²çš„æ£€æµ‹æ¡†åˆå¹¶äº†ã€‚

### 2. æ£€æŸ¥ HTML æŠ¥å‘Š

æ‰“å¼€ `extraction_report.html`ï¼ŒæŸ¥çœ‹ï¼š

#### âœ… å¥½çš„è¿¹è±¡ï¼š
- å›¾è¡¨å®Œæ•´ï¼Œæ²¡æœ‰è¢«åˆ‡å‰²
- å­å›¾ï¼ˆå¦‚ a, b, cï¼‰è¢«åˆå¹¶ä¸ºä¸€ä¸ªæ•´ä½“
- æ²¡æœ‰å•ç‹¬çš„ç®­å¤´æˆ–è¿æ¥çº¿
- è¾¹ç•Œæ¡†ç´§è´´å†…å®¹ï¼Œæ²¡æœ‰è¿‡å¤šç©ºç™½

#### âŒ éœ€è¦æ”¹è¿›çš„è¿¹è±¡ï¼š
- å›¾è¡¨è¢«åˆ‡æˆå¤šå—
- å¤šä¸ªç‹¬ç«‹å›¾è¡¨è¢«é”™è¯¯åˆå¹¶
- ç®­å¤´ä»è¢«å•ç‹¬è¯†åˆ«
- è¾¹ç•Œæ¡†ä¸å‡†ç¡®

### 3. å¯¹æ¯”æ”¹è¿›å‰å

```bash
# è¿è¡Œå¯¹æ¯”æµ‹è¯•
python tests/test_comparison.py
```

æŸ¥çœ‹è¾“å‡ºä¸­çš„å¯¹æ¯”ç»Ÿè®¡ã€‚

## ğŸ”§ è°ƒæ•´å‚æ•°ä¼˜åŒ–æ•ˆæœ

å¦‚æœæ•ˆæœä¸ç†æƒ³ï¼Œå¯ä»¥è°ƒæ•´é…ç½®æ–‡ä»¶ `config/figtabminer.json`ï¼š

### å‡å°‘è¿‡åº¦åˆ†å‰²ï¼ˆåˆå¹¶æ›´æ¿€è¿›ï¼‰

```json
{
  "figure_merge_iou": 0.2,  // é™ä½ IoU é˜ˆå€¼ï¼ˆé»˜è®¤ 0.3ï¼‰
  "bbox_merger": {
    "overlap_threshold": 0.6,  // é™ä½é‡å é˜ˆå€¼ï¼ˆé»˜è®¤ 0.7ï¼‰
    "distance_threshold": 80   // å¢åŠ è·ç¦»é˜ˆå€¼ï¼ˆé»˜è®¤ 50ï¼‰
  }
}
```

### å‡å°‘é”™è¯¯åˆå¹¶ï¼ˆåˆå¹¶æ›´ä¿å®ˆï¼‰

```json
{
  "figure_merge_iou": 0.4,  // æé«˜ IoU é˜ˆå€¼
  "bbox_merger": {
    "overlap_threshold": 0.8,  // æé«˜é‡å é˜ˆå€¼
    "distance_threshold": 30   // å‡å°‘è·ç¦»é˜ˆå€¼
  }
}
```

### æ›´ä¸¥æ ¼çš„ç®­å¤´è¿‡æ»¤

```json
{
  "bbox_merger": {
    "enable_noise_filter": true,
    "arrow_aspect_ratio_min": 4.0,  // é™ä½ï¼ˆé»˜è®¤ 5.0ï¼‰
    "arrow_ink_ratio_max": 0.08     // æé«˜ï¼ˆé»˜è®¤ 0.05ï¼‰
  }
}
```

### ç¦ç”¨æŸäº›åŠŸèƒ½

```json
{
  "bbox_merger": {
    "enable_semantic_merge": false,  // ç¦ç”¨è¯­ä¹‰åˆå¹¶
    "enable_visual_merge": false,    // ç¦ç”¨è§†è§‰åˆå¹¶
    "enable_noise_filter": false     // ç¦ç”¨å™ªå£°è¿‡æ»¤
  }
}
```

## ğŸ“ˆ æ€§èƒ½ç›‘æ§

### æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

```bash
# è®¾ç½®æ—¥å¿—çº§åˆ«ä¸º DEBUG
export FIGTABMINER_LOG_LEVEL=DEBUG

# è¿è¡Œæå–
python scripts/run_pipeline.py --pdf your_paper.pdf
```

æ—¥å¿—ä¼šæ˜¾ç¤ºï¼š
- æ¯ä¸ªåˆå¹¶å†³ç­–çš„åŸå› 
- è¿‡æ»¤æ‰çš„é¡¹ç›®
- è´¨é‡è¯„åˆ†è¯¦æƒ…

### æ£€æŸ¥è´¨é‡åˆ†æ•°

åœ¨ç”Ÿæˆçš„ `manifest.json` ä¸­ï¼Œæ¯ä¸ª item éƒ½æœ‰è´¨é‡è¯„åˆ†ï¼š

```json
{
  "item_id": "fig_0001",
  "quality_score": 0.85,
  "quality_details": {
    "detection_conf": 0.9,
    "content_completeness": 0.8,
    "caption_match": 0.9,
    "size_reasonableness": 1.0,
    "position_reasonableness": 1.0
  }
}
```

ä½äº 0.5 çš„é¡¹ç›®å¯èƒ½æœ‰é—®é¢˜ã€‚

## ğŸ› å¸¸è§é—®é¢˜

### Q1: æ¨¡å‹åŠ è½½å¤±è´¥

**ç—‡çŠ¶**ï¼šçœ‹åˆ° "Unsupported query remaining" é”™è¯¯

**è§£å†³**ï¼š
```bash
# è¿è¡Œä¿®å¤æµ‹è¯•
python tests/test_layout_fix.py

# å¦‚æœä»ç„¶å¤±è´¥ï¼Œæ‰‹åŠ¨æ¸…ç†ç¼“å­˜
rm -rf ~/.torch/iopath_cache/*/model_final.pth?dl=1*
```

### Q2: åˆå¹¶ç‡å¤ªé«˜/å¤ªä½

**è§£å†³**ï¼šè°ƒæ•´ `config/figtabminer.json` ä¸­çš„é˜ˆå€¼ï¼ˆè§ä¸Šæ–‡ï¼‰

### Q3: ç®­å¤´ä»è¢«è¯†åˆ«

**è§£å†³**ï¼š
1. æ£€æŸ¥ç®­å¤´çš„é•¿å®½æ¯”å’Œå¢¨æ°´æ¯”ä¾‹
2. è°ƒæ•´ `arrow_aspect_ratio_min/max` å’Œ `arrow_ink_ratio_max`
3. ç¡®ä¿ `enable_noise_filter` ä¸º `true`

### Q4: å­å›¾æ²¡æœ‰åˆå¹¶

**è§£å†³**ï¼š
1. ç¡®ä¿ `enable_semantic_merge` ä¸º `true`
2. æ£€æŸ¥å­å›¾æ˜¯å¦æœ‰å…±åŒçš„ caption
3. å¢åŠ  `distance_threshold`

### Q5: è¡¨æ ¼è¯†åˆ«ä¸åˆ°

**è§£å†³**ï¼š
1. æ£€æŸ¥ `layout_enable` æ˜¯å¦ä¸º `"auto"` æˆ– `"true"`
2. é™ä½ `layout_score` é˜ˆå€¼ï¼ˆé»˜è®¤ 0.5ï¼‰
3. æŸ¥çœ‹æ—¥å¿—äº†è§£ä¸ºä»€ä¹ˆè¢«è¿‡æ»¤

## ğŸ“ ä¸‹ä¸€æ­¥

### ç«‹å³å¯åšï¼š

1. **åœ¨ä½ çš„ PDF ä¸Šæµ‹è¯•**
   ```bash
   python scripts/run_pipeline.py --pdf your_paper.pdf
   python tools/visualize_results.py
   ```

2. **è°ƒæ•´å‚æ•°**
   - æ ¹æ®ç»“æœè°ƒæ•´ `config/figtabminer.json`
   - é‡æ–°è¿è¡Œæµ‹è¯•éªŒè¯

3. **æ”¶é›†é—®é¢˜æ¡ˆä¾‹**
   - è®°å½•æ•ˆæœä¸å¥½çš„ PDF
   - æˆªå›¾ä¿å­˜é—®é¢˜ç¤ºä¾‹
   - ä¸ºä¸‹ä¸€è½®ä¼˜åŒ–æä¾›ä¾æ®

### éœ€è¦æ›´å¤šæ—¶é—´ï¼š

1. **åˆ›å»ºæ ‡æ³¨æ•°æ®**
   - æ‰‹åŠ¨æ ‡æ³¨ 50-100 ä¸ª PDF
   - è®¡ç®—å‡†ç¡®ç‡å’Œå¬å›ç‡

2. **é›†æˆæ›´å¼ºæ¨¡å‹**
   - DocLayout-YOLOï¼ˆå·²è®¾è®¡ï¼Œæœªå®ç°ï¼‰
   - Table Transformerï¼ˆå·²è®¾è®¡ï¼Œæœªå®ç°ï¼‰

3. **æ€§èƒ½ä¼˜åŒ–**
   - æ‰¹å¤„ç†
   - ç¼“å­˜
   - å¹¶è¡Œå¤„ç†

## ğŸ’¡ æœ€ä½³å®è·µ

1. **å…ˆç”¨é»˜è®¤é…ç½®æµ‹è¯•** - äº†è§£åŸºçº¿æ€§èƒ½
2. **é€æ­¥è°ƒæ•´å‚æ•°** - ä¸€æ¬¡åªæ”¹ä¸€ä¸ªå‚æ•°
3. **ä¿å­˜å¥½çš„é…ç½®** - å¤‡ä»½æœ‰æ•ˆçš„é…ç½®æ–‡ä»¶
4. **è®°å½•é—®é¢˜æ¡ˆä¾‹** - å¸®åŠ©æŒç»­æ”¹è¿›
5. **å®šæœŸæ›´æ–°** - å…³æ³¨æ–°ç‰ˆæœ¬å’Œæ”¹è¿›

## ğŸ“ è·å–å¸®åŠ©

1. **æŸ¥çœ‹æ—¥å¿—** - å¤§å¤šæ•°é—®é¢˜å¯ä»¥ä»æ—¥å¿—ä¸­æ‰¾åˆ°çº¿ç´¢
2. **é˜…è¯»æ–‡æ¡£**ï¼š
   - `IMPROVEMENTS_SUMMARY.md` - æ”¹è¿›æ€»ç»“
   - `IMPROVEMENTS.md` - è¯¦ç»†æ”¹è¿›æ—¥å¿—
   - `docs/design.md` - è®¾è®¡æ–‡æ¡£
3. **è¿è¡Œæµ‹è¯•** - éªŒè¯åŠŸèƒ½æ˜¯å¦æ­£å¸¸

## ğŸ‰ å¼€å§‹ä½¿ç”¨

```bash
# 1. è¿è¡Œæµ‹è¯•éªŒè¯ç³»ç»Ÿæ­£å¸¸
bash run_tests.sh

# 2. å¤„ç†ä½ çš„ PDF
python scripts/run_pipeline.py --pdf your_paper.pdf

# 3. æŸ¥çœ‹ç»“æœ
python tools/visualize_results.py
firefox extraction_report.html

# 4. å¦‚æœéœ€è¦ï¼Œè°ƒæ•´é…ç½®å¹¶é‡æ–°è¿è¡Œ
vim config/figtabminer.json
python scripts/run_pipeline.py --pdf your_paper.pdf
```

ç¥ä½¿ç”¨æ„‰å¿«ï¼ğŸš€
